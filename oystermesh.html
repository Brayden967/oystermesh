<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Oyster | Immutable, Sustainable, Unstoppable.</title>
    <meta name="description" content="The Oyster Mesh provides decentralized access to immutable data and currency.">
    <script src="oystermesh.js"></script>
    <script src="oy_resources/peer.min.js"></script>
    <script src="oy_resources/sha1.js"></script>
    <script src="oy_resources/aes.js"></script>
    <script src="oy_resources/pbkdf2.js"></script>
    <base target="_blank">
    <style type="text/css">
        @font-face {
            font-family: 'geo_med';
            src: url('oy_resources/geo_med.ttf') format('truetype');
        }

        @font-face {
            font-family: 'geo_light';
            src: url('oy_resources/geo_light.ttf') format('truetype');
        }

        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: geo_light, Fallback, sans-serif;
            color: #d7d7d7;
            background-image: radial-gradient(circle, #ababab, #727272, #404040);
        }

        rect {
            fill: none;
            pointer-events: all;
        }

        .node {
            fill: #348fab;
            z-index: 100;
        }

        .self {
            fill: #ca2465;
            z-index: 100;
        }

        .peer {
            fill: #8a3789;
            z-index: 100;
        }

        .link {
            stroke: #314a91;
            z-index: -100;
        }

        .link_peer {
            stroke: #7a3479;
            z-index: -100;
        }

        @-webkit-keyframes fade_in {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fade_in {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes bounce {
            0% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(2vh);
            }
        }

        @keyframes expand {
            0% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1.1);
            }
        }

        @-webkit-keyframes flash {
            0% { opacity: 1; }
            50% { opacity: .25; }
            100% { opacity: 1; }
        }
        @keyframes flash {
            0% { opacity: 1; }
            50% { opacity: .25; }
            100% { opacity: 1; }
        }

        @-webkit-keyframes flash_green {
            0% { background-color: rgba(36, 171, 38, 0.9); }
            50% { background-color: rgba(36, 171, 38, 0.3); }
            100% { background-color: rgba(36, 171, 38, 0.9); }
        }
        @keyframes flash_green {
            0% { background-color: rgba(36, 171, 38, 0.9); }
            50% { background-color: rgba(36, 171, 38, 0.3); }
            100% { background-color: rgba(36, 171, 38, 0.9); }
        }

        .oy_button_execute_active {
            background-color: #14a2cc;
            border:0.1vh solid #14a2cc;
            color: #f3f3f3;
        }

        .oy_button_execute_active:hover {
            cursor: pointer;
        }

        .oy_button_halt_active {
            background-color: #c37b2c;
            border:0.1vh solid #c37b2c;
            color: #f3f3f3;
        }

        .oy_button_halt_active:hover {
            cursor: pointer;
        }

        .oy_button_reset_active {
            background-color: #525252;
            border:0.1vh solid #525252;
            color: #f3f3f3;
        }

        .oy_button_reset_active:hover {
            cursor: pointer;
        }

        .oy_button_view_close {
            background-color: #14a2cc;
            border:0.1vh solid #14a2cc;
            color: #f3f3f3;
        }

        .oy_button_view_close:hover {
            cursor: pointer;
        }

        .oy_button_view_download {
            background-color: #2f2f2f;
            border:0.1vh solid #2f2f2f;
            color: #f3f3f3;
        }

        .oy_button_pull_go {
            background-color: #24ab26;
            border:0.1vh solid #24ab26;
            color: #f3f3f3;
        }

        .oy_button_pull_go:hover {
            cursor: pointer;
        }

        .oy_button_view_download:hover {
            cursor: pointer;
        }

        .oy_button_all_active {
            background-color: #696969;
            border:0.1vh solid #696969;
            color: #111111;
        }

        .oy_button_all_active:hover {
            cursor: pointer;
        }

        .oy_button_all_dull {
            background-color: #7A7A7A;
            border:0.1vh solid #7A7A7A;
            color: #4a4a4a;
        }

        .oy_button_all_dull:hover {
            cursor: not-allowed;
        }

        .oy_slide {
            position: relative;
            top: 0;
            width: 100%;
            height: 85%;
            overflow: hidden;
        }

        a {
            color:black;
        }

        .oy_fade {
            opacity: 0;
            animation: fade_in ease-in 1;
            animation-fill-mode: forwards;
        }

        .oy_fade.one {
            animation-duration: 0.4s;
        }

        .oy_fade.two {
            animation-delay: 0.1s;
            animation-duration: 0.25s;
        }
        @media screen and (orientation: landscape) {
            .oy_shell_img {
                position: relative;
                width: auto;
                height: auto;
                max-height: 20vh;
                max-width: 28vh;
                top: 0;
                left: 0;
                animation: bounce 11s ease-in-out infinite;
                animation-delay: 0.1s;
                z-index: 100;
            }

            .oy_shell_cont_img {
                position: absolute;
                top: 6vh;
                left: 50%;
                height: 27vh;
                transform: translateX(-50%);
            }

            .oy_shadow {
                position: absolute;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 6.5vh;
                animation: expand 5.5s ease-in-out infinite;
                animation-direction: alternate;
                animation-delay: 0.1s;
            }

            .oy_holder {
                position:absolute;
                left:50%;
                transform:translateX(-50%);
                top:35vh;
                width: 110vh;
                height: 58vh;
                z-index: 1000;
            }

            .oy_tab {
                border-radius: 0.5vh;
                padding: 0.5vh 1vh;
                font-size:1.7vh;
                font-family: geo_med, Fallback, sans-serif;
            }

            .oy_tab:hover {
                cursor: pointer;
            }

            .oy_description {
                position:absolute;
                top:0;
                left:0;
                transform: translateY(-100%);
                font-size:1.5vh;
            }

            .oy_description_handle {
                position:absolute;
                top:0;
                left:0;
                transform: translateY(-100%);
                font-size:1.8vh;
            }

            .oy_superhandle {
                position:absolute;
                top:18%;
                left:5%;
                width:90%;
                height:20%;
                border:0.1vh dashed #727272;
            }

            .oy_superhandle_sub {
                font-size:0.95vh;
                font-family: 'Courier New', sans-serif;
            }

            .oy_superhandle_sub:hover {
                cursor: pointer;
            }

            .oy_box {
                position:absolute;
                bottom:14%;
                left:41%;
                width:32.5%;
                height:30%;
                border:0.1vh dashed #727272;
                font-size:1vh;
            }

            .oy_mesh_glue {
                position:absolute;
                bottom:14%;
                left:23.5%;
                width:14%;
                height:30%;
                border:0.1vh dashed #727272;
                font-size:1vh;
            }

            .oy_mesh_glue_sub {
                position:absolute;
                top:50%;
                left:50%;
                transform: translate(-37%, -50%);
                width:90%;
                font-family: "Courier New", Fallback, sans-serif;
                font-size:1.5vh;
            }

            .oy_button {
                border-radius: 0.5vh;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-family: geo_med, Fallback, sans-serif;
                font-size:1.5vh;
            }

            .oy_border {
                border-radius: 0.5vh;
            }

            .oy_border.oy_graph_nonce {
                border:0.2vh solid #404040;
            }

            .oy_border.oy_interface_main {
                border:0.2vh solid #404040;
            }

            .oy_peer {
                position:absolute;
                left:5%;
                width:90%;
                height:12%;
                border:0.1vh dashed #727272;
                color:#000000;
                font-weight:bold;
            }

            .oy_peer_sub {
                position:absolute;
                left:0;
                top:0;
                width:100%;
                height:100%;
            }

            .oy_peer_beam {
                position:absolute;
                left:0;
                top:0;
                width:100%;
                height:100%;
                background-color: #626262;
            }

            .oy_peer_soak {
                position:absolute;
                left:0;
                top:0;
                width:100%;
                height:100%;
                background-color: #7A7A7A;
            }

            .oy_stats {
                font-size:1.6vh;
            }

            .oy_pull_stats {
                position:absolute;
                top:17%;
                width:50%;
                height:100%;
                font-size:1.1vh;
            }

            #oy_console {
                width:96%;
                height:99%;
                overflow: scroll;
                font-family:'Courier New', sans-serif;
                font-size: 1vh;
            }

            .oy_tooltip {
                position: absolute;
            }

            .oy_tooltip .oy_tooltip_text {
                position: absolute;
                width: 12vh;
                background-color: #555;
                color: #fff;
                text-align: center;
                border-radius: 0.6vh;
                padding: 0.6vh;
                z-index: 1;
                bottom: 150%;
                left: 50%;
                margin-left: -5.5vh;
                opacity: 0;
            }

            .oy_tooltip .oy_tooltip_text::after {
                content: "";
                position: absolute;
                top: 100%;
                left: 50%;
                margin-left: -0.6vh;
                border-width: 0.6vh;
                border-style: solid;
                border-color: #555 transparent transparent transparent;
            }

            .oy_tooltip:hover .oy_tooltip_text {
                opacity: 1;
            }

            .oy_tooltip_warn {
                position: absolute;
            }

            .oy_tooltip_warn .oy_tooltip_text_warn {
                position: absolute;
                width: 13vh;
                background-color: #c37b2c;
                color: #151515;
                text-align: center;
                border-radius: 0.6vh;
                padding: 0.6vh;
                z-index: 1;
                bottom: 150%;
                left: 50%;
                margin-left: -5.5vh;
                opacity: 0;
            }

            .oy_tooltip_warn .oy_tooltip_text_warn::after {
                content: "";
                position: absolute;
                top: 100%;
                left: 50%;
                margin-left: -0.6vh;
                border-width: 0.6vh;
                border-style: solid;
                border-color: #c37b2c transparent transparent transparent;
            }

            .oy_signature {
                position:absolute;
                left:0;
                bottom:0;
                width:100%;
                height:5%;
                color:#000;
                font-size: 1.2vh;
            }

            .oy_signature_img {
                position: relative;
                width: auto;
                height: auto;
                max-height: 1.6vh;
                max-width: 1.6vh;
                transform:translateY(25%);
            }

            #oy_github_ribbon a:hover {
                background: #14a2cc;
                color: #fff;
            }

            #oy_github_ribbon a::before, #github_ribbon a::after {
                content: "";
                width: 100%;
                display: block;
                position: absolute;
                top: 0.1vh;
                left: 0;
                height: 0.1vh;
                background: #0f0f0f;
            }

            #oy_github_ribbon a::after {
                bottom: 0.1vh;
                top: auto;
            }

            #oy_github_ribbon {
                position: absolute;
                display: block;
                top: 0;
                right: 0;
                width: 20vw;
                overflow: hidden;
                height: 20vh;
                z-index: 9999;
            }

            #oy_github_ribbon a {
                background: #000;
                color: #f7f7f7;
                text-decoration: none;
                font-family: arial, sans-serif;
                text-align: center;
                font-weight: bold;
                padding: 0.5vh 4vh;
                font-size: 1.5vh;
                line-height: 3vh;
                transition: 0.5s;
                width: 20vh;
                position: absolute;
                top: 6vh;
                right: -6vh;
                transform: rotate(45deg);
            }
        }
        @media screen and (orientation: portrait) {
            .oy_shell_img {
                position: relative;
                width: auto;
                height: auto;
                max-height: 20vw;
                max-width: 28vw;
                top: 0;
                left: 0;
                animation: bounce 11s ease-in-out infinite;
                animation-delay: 0.1s;
                z-index: 100;
            }

            .oy_shell_cont_img {
                position: absolute;
                top: 12vw;
                left: 50%;
                height: 27vw;
                transform: translateX(-50%);
            }

            .oy_shadow {
                position: absolute;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 6.5vw;
                animation: expand 5.5s ease-in-out infinite;
                animation-direction: alternate;
                animation-delay: 0.1s;
            }

            .oy_holder {
                position:absolute;
                left:50%;
                transform:translateX(-50%);
                top: 41vw;
                width: 80vw;
                height: 60vw;
                z-index: 10000;
            }

            .oy_border {
                border-radius: 0.5vw;
            }

            #oy_github_ribbon a:hover {
                background: #14a2cc;
                color: #fff;
            }

            #oy_github_ribbon a::before, #oy_github_ribbon a::after {
                content: "";
                width: 100%;
                display: block;
                position: absolute;
                top: 0.1vw;
                left: 0;
                height: 0.1vw;
                background: #f7f7f7;
            }

            #oy_github_ribbon a::after {
                bottom: 0.1vw;
                top: auto;
            }

            #oy_github_ribbon {
                position: absolute;
                display: block;
                top: 0;
                right: 0;
                width: 20vw;
                overflow: hidden;
                height: 20vw;
                z-index: 9999;
            }

            #oy_github_ribbon a {
                background: #000;
                color: #f7f7f7;
                text-decoration: none;
                font-family: arial, sans-serif;
                text-align: center;
                font-weight: bold;
                padding: 0.5vw 4vw;
                font-size: 1.5vw;
                line-height: 3vw;
                transition: 0.5s;
                width: 20vw;
                position: absolute;
                top: 6vw;
                right: -6vw;
                transform: rotate(45deg);
            }
        }
        .oy_center_hor {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .oy_center_both {
            position: absolute;
            top:50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
    <script src="oy_resources/d3.v3.min.js"></script>
</head>
<body>
<span id="oy_github_ribbon" class="oy_fade two"><a href="https://github.com/brunoblock/oystermesh" target="_blank">GITHUB REPO</a></span>
<div id="front" class="oy_slide" style="height:100%">
    <div id="oy_cover" style="position:absolute;left:0;top:0;width:100%;height:100%;background-color:#0f0f0f;opacity:0.85;z-index:2000;display:none;"></div>
    <div id="oy_file_view_cont" style="position: absolute;top:50%;left:50%;transform: translate(-50%, -52%);width:auto;height:auto;background-color:#121212;padding:1.5%;border-top-left-radius:0.5vh;border-top-right-radius:0.5vh;z-index: 3000;display: none;">
        <div id="oy_file_view_data"></div>
        <div style="position:absolute;left:0;bottom:0;transform:translateY(99%);border-bottom-left-radius:0.5vh;border-bottom-right-radius:0.5vh;width: 100%;min-width:23vh;height:4vh;background-color:#121212;">
            <div id="oy_view_close" align="center" class="oy_button oy_button_view_close" style="position:absolute;bottom:25%;right:2.5vh;width:6.5vh;height:48%;" onclick="oy_file_view_close()">
                <div style="position:relative;top:-3%;">
                    CLOSE
                </div>
            </div>
            <div id="oy_view_download" align="center" class="oy_button oy_button_view_download" style="position:absolute;bottom:25%;right:11vh;width:10vh;height:48%;" onclick="oy_file_download()">
                <div style="position:relative;top:-3%;">
                    DOWNLOAD
                </div>
            </div>
        </div>
    </div>
    <div class="oy_fade one oy_shell_cont_img">
        <img alt="Oyster" class="oy_shell_img" src="oy_resources/oy_logo_shell.png"/>
        <div class="oy_shadow">
            <div style="position:relative;width:100%;height:100%;background: rgba(48, 48, 48, 0.20);border-radius:50%;filter: blur(8px);">
                <div style="position:absolute;left:50%;top:50%;transform: translateX(-50%) translateY(-50%);width:75%;height:50%;background: rgba(70, 70, 70, 0.40);border-radius:50%;z-index:20"></div>
            </div>
        </div>
    </div>
    <div class="oy_holder oy_fade two">
        <div id="oy_graph_nonce" class="oy_center_hor oy_border oy_graph_nonce" style="top:0;width:50%;height:10%;background-color: #404040;overflow: hidden"></div>
        <div id="oy_interface_main" class="oy_center_hor" style="top:18%;width:50%;height:25%;">
            <div id="oy_tab_dapper" class="oy_tab oy_left" style="position:fixed;top:-20%;left: 10%;height:20%;background-color: #7A7A7A;color:#232323;z-index:-50;" onclick="oy_tab(this.id)">DAPPER</div>
            <div id="oy_tab_wallet" class="oy_tab" style="position:fixed;top:-20%;left: 37%;height:20%;transform: translateX(-50%);background-color: #7A7A7A;color:#232323;z-index:-50;" onclick="oy_tab(this.id)">WALLET</div>
            <div id="oy_tab_upload" class="oy_tab" style="position:fixed;top:-20%;left:57%;height:20%;transform: translateX(-50%);background-color: #404040;z-index:-50;" onclick="oy_tab(this.id)">UPLOAD</div>
            <div id="oy_tab_download" class="oy_tab oy_right" style="position:fixed;top:-20%;right: 10%;height:20%;background-color: #7A7A7A;color:#232323;z-index:-50;" onclick="oy_tab(this.id)">DOWNLOAD</div>
            <div id="oy_interface_dapper" class="oy_center_hor oy_border oy_interface_main" style="top:0;width:100%;height:100%;background-color: #404040;z-index:100;display:none">
                <div align="center" class="oy_center_both">
                    Under&nbsp;Development<br>
                    <a href="https://github.com/brunoblock" style="color: #2a2a2a;font-weight:bold;">github.com/brunoblock</a>
                </div>
            </div>
            <div id="oy_interface_wallet" class="oy_center_hor oy_border oy_interface_main" style="top:0;width:100%;height:100%;background-color: #404040;z-index:100;display:none">
                <div align="center" class="oy_center_both">
                    Under&nbsp;Development<br>
                    <a href="https://github.com/brunoblock" style="color: #2a2a2a;font-weight:bold;">github.com/brunoblock</a>
                </div>
            </div>
            <div id="oy_interface_upload" class="oy_center_hor oy_border oy_interface_main" style="top:0;width:100%;height:100%;background-color: #404040;z-index:100;">
                <div align="center" class="oy_border oy_superhandle oy_tooltip oy_tooltip_warn">
                    <div class="oy_description_handle">HANDLE</div>
                    <div class="oy_center_both" style="width:100%;">
                        <div id="oy_tooltip_push" class="oy_tooltip_text" style="display:none;">Copy to clipboard</div>
                        <div id="oy_tooltip_push_warn" class="oy_tooltip_text_warn">Handle not copied!</div>
                        <input id="oy_push_superhandle" type="text" class="oy_superhandle_sub" style="text-align:center;width:98%;" onclick="oy_push_superhandle_copy()" onmouseout="oy_push_superhandle_reset()" readonly="readonly" value="" />
                    </div>
                </div>
                <div id="oy_push_stats_cont" class="oy_border oy_box" style="left:5%;width:15%;">
                    <div class="oy_description">STATISTICS</div>
                    <div id="oy_push_stats_alpha" class="oy_pull_stats" style="left:7.5%">
                        AVG&nbsp;HOP:&nbsp;<span id="oy_push_stats_avg_hop" style="font-weight:bold">0</span><br>
                        TIME:&nbsp;<span id="oy_push_stats_elapsed" style="font-weight:bold">0&nbsp;sec</span>
                    </div>
                </div>
                <div id="oy_push_mesh_glue" class="oy_border oy_mesh_glue">
                    <div class="oy_description">MESH&nbsp;GLUE</div>
                    <div id="oy_push_mesh_glue_sub" class="oy_mesh_glue_sub">
                        G-/--%
                    </div>
                </div>
                <div class="oy_border oy_box">
                    <div class="oy_description">FILE&nbsp;UPLOAD</div>
                    <div style="position:absolute;top:25%;left:5%;width:94%;overflow:hidden">
                        <input type="file" id="oy_file_upload" onclick="oy_push_reset()" onmouseenter="oy_push_reset_handle_enter()" onmouseleave="oy_push_reset_handle_leave()" />
                    </div>
                </div>
                <div id="oy_push_execute" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:32%;right:5%;width:18%;height:14%;" onclick="oy_push_execute()">
                    <div style="position:relative;top:-3%;">
                        MESH&nbsp;PUSH
                    </div>
                </div>
                <div id="oy_push_halt" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:14%;right:15.5%;width:7.5%;height:14%;" onclick="oy_push_halt()">
                    <div style="position:relative;top:-3%;">
                        HALT
                    </div>
                </div>
                <div id="oy_push_reset" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:14%;right:5%;width:9.5%;height:14%;" onclick="oy_push_reset()" onmouseenter="oy_push_reset_handle_enter()" onmouseleave="oy_push_reset_handle_leave()">
                    <div style="position:relative;top:-3%;">
                        RESET
                    </div>
                </div>
            </div>
            <div id="oy_interface_download" class="oy_center_hor oy_border oy_interface_main" style="top:0;width:100%;height:100%;background-color: #404040;z-index:100;display:none">
                <div align="center" class="oy_border oy_superhandle">
                    <div class="oy_description_handle">HANDLE</div>
                    <div class="oy_center_both" style="width:100%;">
                        <input id="oy_pull_superhandle" type="text" class="oy_superhandle_sub" style="text-align:center;width:98%;" onclick="oy_pull_reset_handle_click()" oninput="oy_pull_reset_handle_blur()" onchange="oy_pull_reset_handle_blur()" value="" />
                    </div>
                </div>
                <div id="oy_pull_stats_cont" class="oy_border oy_box" style="left:5%;">
                    <div class="oy_description">STATISTICS</div>
                    <div id="oy_pull_stats_alpha" class="oy_pull_stats" style="left:3.5%">
                        AVG&nbsp;HOP:&nbsp;<span id="oy_pull_stats_avg_hop" style="font-weight:bold">0</span><br>
                        TIME:&nbsp;<span id="oy_pull_stats_elapsed" style="font-weight:bold">0&nbsp;sec</span>
                    </div>
                    <div id="oy_pull_stats_beta" class="oy_pull_stats" style="right:0">
                        COVERAGE:&nbsp;<span id="oy_pull_stats_coverage" style="font-weight:bold">0%</span><br>
                        CONFLICTS:&nbsp;<span id="oy_pull_stats_conflicts" style="font-weight:bold">0</span>
                    </div>
                </div>
                <div id="oy_pull_mesh_glue" class="oy_border oy_mesh_glue" style="display:none;">
                    <div class="oy_description">MESH&nbsp;GLUE</div>
                    <div id="oy_pull_mesh_glue_sub" class="oy_mesh_glue_sub">
                        G-/--%
                    </div>
                </div>
                <div class="oy_border oy_box">
                    <div class="oy_description">DESTINATION</div>
                    <div style="position:absolute;top:0;left:4%;height:100%;width:100%;">
                        <div style="position:absolute;top:0;"><input id="oy_dest_recommit" type="radio" style="transform:scale(0.8);" onclick="oy_dest_radio(this.id)">&nbsp;<span id="oy_dest_recommit_inner">Recommit&nbsp;to&nbsp;mesh</span></div>
                        <div style="position:absolute;top:50%;transform: translateY(-50%)"><input id="oy_dest_view" type="radio" style="transform:scale(0.8);" onclick="oy_dest_radio(this.id)">&nbsp;<span id="oy_dest_view_inner">View&nbsp;in&nbsp;browser</span></div>
                        <div style="position:absolute;bottom:0;"><input id="oy_dest_download" type="radio" style="transform:scale(0.8);" onclick="oy_dest_radio(this.id)">&nbsp;<span id="oy_dest_download_inner">Download&nbsp;as&nbsp;file</span></div>
                        <div id="oy_dest_go" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:28%;right:15%;width:18%;height:45%;" onclick="oy_dest_go()">
                            <div style="position:relative;top:-3%;">
                                GO
                            </div>
                        </div>
                    </div>
                </div>
                <div id="oy_pull_execute" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:32%;right:5%;width:18%;height:14%;" onclick="oy_pull_execute()">
                    <div style="position:relative;top:-3%;">
                        MESH&nbsp;PULL
                    </div>
                </div>
                <div id="oy_pull_halt" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:14%;right:15.5%;width:7.5%;height:14%;" onclick="oy_pull_halt()">
                    <div style="position:relative;top:-3%;">
                        HALT
                    </div>
                </div>
                <div id="oy_pull_reset" align="center" class="oy_button oy_button_all_dull" style="position:absolute;bottom:14%;right:5%;width:9.5%;height:14%;" onclick="oy_pull_reset()">
                    <div style="position:relative;top:-3%;">
                        RESET
                    </div>
                </div>
            </div>
        </div>
        <div class="oy_border oy_graph_nonce" style="position:absolute;bottom:0;left:0;width:49%;height:53%;background-color: #404040;overflow: hidden" onmouseenter="oy_console_hover_on()" onmouseleave="oy_console_hover_off()">
            <div id="oy_console_hover_indicator" style="position:absolute;top:1%;right:1%;width:2.5%;height:4%;background-color: #c37b2c;border-radius: 50%;display: none;z-index: 200;"></div>
            <div id="oy_console" class="oy_center_both">***<br></div>
        </div>
        <div id="oy_graph_nodes" class="oy_border oy_graph_nonce" style="position:absolute;bottom:0;right:0;width:49%;height:53%;background-color: #404040;overflow:hidden;">
            <div id="oy_top_inner" style="position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);overflow:hidden;"></div>
        </div>
        <div id="oy_stats" class="oy_border oy_graph_nonce" style="position:absolute;top:0;left:0;width:23%;height:43%;background-color: #404040;overflow:hidden;">
            <div class="oy_center_both oy_stats" style="top:46%;height:77%;width:100%;">
                <div align="right" style="position:absolute;left:-2.5%;top:0;width:50%;height:100%;">
                    SELF&nbsp;SHORT&nbsp;ID<br>
                    SELF CAPACITY<br>
                    AVG&nbsp;LATENCY<br>
                    AVG&nbsp;PEERSHIP<br>
                    PEER&nbsp;COUNT<br>
                    BLACKLISTED<br>
                    MESH&nbsp;RANGE<br>
                    BEAM&nbsp;FLOW<br>
                    SOAK&nbsp;FLOW<br>
                </div>
                <div class="oy_center_hor" style="top:0;width:0.7%;height:95%;background-color: #2a2a2a;">
                </div>
                <div style="position:absolute;right:-2.5%;top:0;width:50%;height:100%;font-weight:bold;">
                    <span id="oy_self_short">null</span><br>
                    <span id="oy_storage_limit">0</span>&nbsp;MB<br>
                    <span id="oy_avg_latency">0</span>&nbsp;sec<br>
                    <span id="oy_avg_peership">0</span>&nbsp;min<br>
                    <span id="oy_peer_count_cont"><span id="oy_peer_count">0</span>&nbsp;peer(s)</span><br>
                    <span id="oy_blacklisted">0</span>&nbsp;node(s)<br>
                    <span id="oy_mesh_range">0</span>&nbsp;node(s)<br>
                    <span id="oy_beam_flow">0</span>&nbsp;kbps<br>
                    <span id="oy_soak_flow">0</span>&nbsp;kbps<br>
                </div>
                <div id="oy_self_reset" align="center" class="oy_button oy_button_all_active" style="position:absolute;bottom:-12%;left:30%;transform:translateX(-50%);width:40%;height:10%;" onclick="oy_self_reset()">
                    <div style="position:relative;top:-3%;">
                        RESET&nbsp;NODE
                    </div>
                </div>
                <div id="oy_obj_top" align="center" class="oy_button oy_button_all_active" style="position:absolute;bottom:-12%;left:70%;transform:translateX(-50%);width:30%;height:10%;" onclick="oy_self_reset()">
                    <div style="position:relative;top:-3%;">
                        OBJ&nbsp;TOP
                    </div>
                </div>
            </div>
        </div>
        <div id="oy_graph_peers" class="oy_border oy_graph_nonce" style="position:absolute;top:0;right:0;width:23%;height:43%;background-color: #404040;">
            <div id="oy_graph_slot_4" class="oy_peer" style="top:4%;"></div>
            <div id="oy_graph_slot_3" class="oy_peer" style="top:24%;"></div>
            <div id="oy_graph_slot_2" class="oy_peer" style="top:44%;"></div>
            <div id="oy_graph_slot_1" class="oy_peer" style="top:64%;"></div>
            <div id="oy_graph_slot_0" class="oy_peer" style="top:84%;"></div>
        </div>
    </div>
    <div class="oy_signature oy_fade two">
        <div class="oy_center_hor" style="top:0;">Designed&nbsp;and&nbsp;developed&nbsp;by&nbsp;<a href="https://github.com/brunoblock"><img alt="Bruno Block" src="oy_resources/oy_logo_bruno.png" class="oy_signature_img" style="left:0.5%;"></a></div>
    </div>
</div>
<script type="text/javascript">
    let oy_local_init = function(oy_block) {
        if (typeof(oy_block)==="undefined") {
            window.OY_CONSOLE_SIZE = 400;
            window.OY_NODE_MAX = 30;
            window.OY_NODE_ADDTIME = 40;
            window.OY_NODE_ACTIVETIME = 150;
            window.OY_LINK_ADDTIME = 60;
            window.OY_LINK_ACTIVETIME = 110;
            window.OY_HOP_KEEP = 100;
            window.OY_MESH_RANGETIME = 30;
            window.OY_DEST_RADIO = "oy_dest_view";

            window.OY_FILE_DATA = null;
            window.OY_FILE_KEEP = null;
            window.OY_MESH_GLUE = [];
            window.OY_MESH_RANGE = [];
            window.OY_HANDLE_PUSH = null;
            window.OY_HANDLE_PUSH_COPY = null;
            window.OY_NONCE_MAX_PUSH = null;
            window.OY_NONCE_MAX_PULL = null;
            window.OY_HANDLE_PULL = null;
            window.OY_GRAPH_NONCE_STORE = {};
            window.OY_EXECUTE_LAST = null;
            window.OY_EXECUTE_PUSH = false;
            window.OY_EXECUTE_PULL = false;
            window.OY_EXECUTE_RECOMMIT = false;
            window.OY_EXECUTE_SEND = false;
            window.OY_EXECUTE_RECEIVE = false;
            window.OY_CONSOLE_COUNTER = 0;
            window.OY_CONSOLE_HOVER = false;
            window.OY_PUSH_ELAPSED = null;
            window.OY_PUSH_AVG_HOP = [];
            window.OY_PULL_AVG_HOP = [];
            window.OY_PULL_ELAPSED = null;
            window.OY_PULL_COVERAGE = [];
            window.OY_PULL_CONFLICTS = {};
            window.OY_PUSH_PAUSE = null;
            window.OY_PULL_PAUSE = null;
            window.OY_RECOMMIT_PAUSE = null;
            window.OY_GRAPH_PEERS = [false, false, false, false, false];
            window.OY_GRAPH_PEERS_PREV = [false, false, false, false, false];
            window.OY_NODE_KEEP = {};
            window.OY_NODE_CHECK = {};
            window.OY_LINK_KEEP = {};

            document.getElementById("oy_push_superhandle").value = "-".repeat(82);
            document.getElementById("oy_pull_superhandle").value = "-".repeat(82);
        }

        document.getElementById(window.OY_DEST_RADIO).checked = true;

        oy_console_local("Loading console...");

        document.getElementById("oy_file_upload").addEventListener('change', oy_file_change, false);

        oy_init(function() {
            document.getElementById("oy_storage_limit").innerHTML = window.OY_DEPOSIT_MAX/1000000;
            oy_top_init();
            window.OY_NODE_KEEP[window.OY_MAIN['oy_self_short']] = true;
            oy_top_node_add(window.OY_MAIN['oy_self_short'], "self");
            if (typeof(oy_block)==="undefined") oy_maintain();
            window.OY_MAP = function(oy_data_flag, oy_passport_passive, oy_passport_active) {
                let oy_time_local = Date.now()/1000|0;
                window.OY_MESH_RANGE.push([oy_time_local, oy_passport_passive.length]);
                if (oy_data_flag==="OY_DATA_FULFILL"&&window.OY_EXECUTE_PULL===true&&oy_passport_passive.length>0&&oy_passport_active.length>0&&oy_passport_active[0]===window.OY_MAIN['oy_self_short']) {
                    window.OY_PULL_AVG_HOP.push(oy_passport_passive.length);
                    while (window.OY_PULL_AVG_HOP.length>window.OY_HOP_KEEP) window.OY_PULL_AVG_HOP.shift();
                    document.getElementById("oy_pull_stats_avg_hop").innerHTML = (window.OY_PULL_AVG_HOP.reduce(oy_reduce_sum)/window.OY_PULL_AVG_HOP.length).toFixed(2);
                }
                if (Object.keys(window.OY_NODE_KEEP).length<=window.OY_NODE_MAX) {
                    let oy_node_prev = false;
                    for (let i in oy_passport_passive) {
                        if (!oy_peer_find(oy_passport_passive[i])) {
                            if (typeof(window.OY_NODE_KEEP[oy_passport_passive[i]])==="undefined") window.OY_NODE_KEEP[oy_passport_passive[i]] = oy_time_local+window.OY_NODE_ADDTIME;
                            else if (window.OY_NODE_KEEP[oy_passport_passive[i]]!==true) {
                                if (window.OY_NODE_KEEP[oy_passport_passive[i]]<oy_time_local) window.OY_NODE_KEEP[oy_passport_passive[i]] = oy_time_local+window.OY_NODE_ADDTIME;
                                else window.OY_NODE_KEEP[oy_passport_passive[i]] += window.OY_NODE_ADDTIME;
                            }
                        }

                        if (oy_node_prev!==false&&(window.OY_NODE_KEEP[oy_node_prev]-oy_time_local>window.OY_NODE_ACTIVETIME||window.OY_NODE_KEEP[oy_node_prev]===true)&&(window.OY_NODE_KEEP[oy_passport_passive[i]]-oy_time_local>window.OY_NODE_ACTIVETIME||window.OY_NODE_KEEP[oy_passport_passive[i]]===true)&&oy_node_prev!==window.OY_MAIN['oy_self_short']&&oy_passport_passive[i]!==window.OY_MAIN['oy_self_short']) {
                            let oy_link_found = false;
                            for (let i in window.OY_TOP_LINKS) {
                                if ((window.OY_TOP_LINKS[i].source.short===oy_node_prev&&window.OY_TOP_LINKS[i].target.short===oy_passport_passive[i])||(window.OY_TOP_LINKS[i].target.short===oy_node_prev&&window.OY_TOP_LINKS[i].source.short===oy_passport_passive[i])) {
                                    oy_link_found = true;
                                    break;
                                }
                            }
                            let oy_local_sort = [oy_node_prev, oy_passport_passive[i]];
                            oy_local_sort.sort();
                            let oy_link_key = oy_local_sort.join("@");
                            if (typeof(window.OY_LINK_KEEP[oy_link_key])==="undefined") window.OY_LINK_KEEP[oy_link_key] = oy_time_local+window.OY_LINK_ADDTIME;
                            else window.OY_LINK_KEEP[oy_link_key] += window.OY_LINK_ADDTIME;
                            if (oy_link_found===false&&window.OY_LINK_KEEP[oy_link_key]-oy_time_local>window.OY_LINK_ACTIVETIME) {
                                oy_top_node_add(oy_node_prev, "node");
                                oy_top_node_add(oy_passport_passive[i], "node");
                                oy_top_link_add(oy_node_prev, oy_passport_passive[i], "#314a91");
                            }
                        }
                        oy_node_prev = oy_passport_passive[i];
                    }
                }
            }
        }, null,
        function(oy_console_msg) {
            oy_console_local(oy_console_msg);
        });
    };

    window.onload = function() {
        oy_local_init();
    };

    function oy_self_reset() {
        oy_top_clear();

        window.OY_MAIN = {"oy_ready":false, "oy_deposit_size":0, "oy_deposit_counter":0};
        window.OY_PEERS = {"oy_aggregate_node":[-1, -1, -1, 0, [], 0, [], 0, []]};
        window.OY_PEER_COUNT = 0;
        window.OY_PROPOSED = {};
        window.OY_BLACKLIST = {};
        oy_local_store("oy_main", window.OY_MAIN);
        oy_local_store("oy_peers", window.OY_PEERS);
        oy_local_store("oy_proposed", window.OY_PROPOSED);
        oy_local_store("oy_blacklist", window.OY_BLACKLIST);

        window.OY_ENGINE_KILL = true;
        window.OY_CONN = null;

        window.OY_INIT = 0;
        oy_local_init(true);
    }

    function oy_maintain() {
        let oy_time_local = Date.now()/1000|0;

        let oy_avg_latency = [];
        let oy_avg_peership = [];
        let oy_avg_beam = [];
        let oy_avg_soak = [];
        let oy_peer_keep = [];
        for (let oy_peer_local in window.OY_PEERS) {
            if (oy_peer_local==="oy_aggregate_node") continue;
            oy_data_measure(true, oy_peer_local, null);
            oy_data_measure(false, oy_peer_local, null);
            oy_peer_keep.push([oy_short(oy_peer_local), window.OY_PEERS[oy_peer_local][3], window.OY_PEERS[oy_peer_local][5], window.OY_PEERS[oy_peer_local][7]]);
            oy_avg_latency.push(window.OY_PEERS[oy_peer_local][3]);
            oy_avg_peership.push(window.OY_PEERS[oy_peer_local][0]);
            oy_avg_beam.push(window.OY_PEERS[oy_peer_local][5]);
            oy_avg_soak.push(window.OY_PEERS[oy_peer_local][7]);
        }

        if (oy_avg_latency.length>0) document.getElementById("oy_avg_latency").innerHTML = (oy_avg_latency.reduce(oy_reduce_sum)/oy_avg_latency.length).toFixed(3);
        if (oy_avg_peership.length>0) document.getElementById("oy_avg_peership").innerHTML = ((oy_time_local - Math.round(oy_avg_peership.reduce(oy_reduce_sum)/oy_avg_peership.length))/60).toFixed(2);
        if (oy_avg_beam.length>0) document.getElementById("oy_beam_flow").innerHTML = (oy_avg_beam.reduce(oy_reduce_sum)/1000).toFixed(2);
        else document.getElementById("oy_beam_flow").innerHTML = "0";
        if (oy_avg_soak.length>0) document.getElementById("oy_soak_flow").innerHTML = (oy_avg_soak.reduce(oy_reduce_sum)/1000).toFixed(2);
        else document.getElementById("oy_soak_flow").innerHTML = "0";

        oy_peer_keep.sort(function(a, b) {
            return b[1] - a[1];
        });

        // noinspection JSUnusedAssignment
        let i = -1;
        for (i in oy_peer_keep) {
            if (i>4) break;
            oy_graph_peer(i, oy_peer_keep[i][0], " - "+oy_peer_keep[i][1].toFixed(3)+"s", Math.round((oy_peer_keep[i][2]/(oy_peer_keep[i][2]+oy_peer_keep[i][3]))*100));
        }
        i++;
        while (i <= 4) {
            oy_graph_peer(i, null, null, 0);
            i++;
        }

        for (let i in window.OY_GRAPH_PEERS) {
            if (window.OY_GRAPH_PEERS[i]===false) continue;
            if (window.OY_GRAPH_PEERS_PREV.indexOf(window.OY_GRAPH_PEERS[i])===-1) {
                if (typeof(window.OY_NODE_KEEP[window.OY_GRAPH_PEERS[i]])!=="undefined") oy_top_node_remove(window.OY_GRAPH_PEERS[i]);
                window.OY_NODE_KEEP[window.OY_GRAPH_PEERS[i]] = true;
                oy_top_node_add(window.OY_GRAPH_PEERS[i], "peer");
                oy_top_link_add(window.OY_MAIN['oy_self_short'], window.OY_GRAPH_PEERS[i], "#314a91");
                let oy_node_present = false;
                for (let oy_node_short in window.OY_NODE_KEEP) {
                    if (window.OY_NODE_KEEP[oy_node_short]!==true) {
                        oy_node_present = true;
                        break;
                    }
                }
            }
        }

        for (let i in window.OY_GRAPH_PEERS_PREV) {
            if (window.OY_GRAPH_PEERS_PREV[i]===false) continue;
            if (window.OY_GRAPH_PEERS.indexOf(window.OY_GRAPH_PEERS_PREV[i])===-1) {
                oy_top_node_remove(window.OY_GRAPH_PEERS_PREV[i]);
                let oy_node_present = false;
                for (let oy_node_short in window.OY_NODE_KEEP) {
                    if (window.OY_NODE_KEEP[oy_node_short]!==true) {
                        oy_node_present = true;
                        break;
                    }
                }
            }
        }

        for (let i in window.OY_GRAPH_PEERS) {
            window.OY_GRAPH_PEERS_PREV[i] = window.OY_GRAPH_PEERS[i];
        }

        for (let oy_node_short in window.OY_NODE_KEEP) {
            if (window.OY_NODE_KEEP[oy_node_short]!==true&&oy_time_local>window.OY_NODE_KEEP[oy_node_short]) oy_top_node_remove(oy_node_short);
        }

        for (let oy_link_key in window.OY_LINK_KEEP) {
            if (oy_time_local>window.OY_LINK_KEEP[oy_link_key]) {
                delete window.OY_LINK_KEEP[oy_link_key];
                let oy_split = oy_link_key.split("@");
                oy_top_link_remove(oy_split[0], oy_split[1]);
            }
        }

        let oy_mesh_range_new = [];
        let oy_mesh_range_highest = 0;
        for (let i in window.OY_MESH_RANGE) {
            if (oy_time_local-window.OY_MESH_RANGE[i][0]<=window.OY_MESH_RANGETIME) {
                oy_mesh_range_new.push(window.OY_MESH_RANGE[i]);
                if (window.OY_MESH_RANGE[i][1]>oy_mesh_range_highest) oy_mesh_range_highest = window.OY_MESH_RANGE[i][1];
            }
        }
        window.OY_MESH_RANGE = oy_mesh_range_new;
        document.getElementById("oy_mesh_range").innerHTML = ""+oy_mesh_range_highest;

        if (window.OY_EXECUTE_PUSH===true) {
            let oy_local_elapsed = ((Date.now()/1000)-window.OY_PUSH_ELAPSED);
            let oy_suffix = "&nbsp;sec";
            if (oy_local_elapsed>60) {
                oy_local_elapsed /= 60;
                oy_suffix = "&nbsp;min";
            }
            if (oy_local_elapsed>60) {
                oy_local_elapsed /= 60;
                oy_suffix = "&nbsp;hrs";
            }
            document.getElementById("oy_push_stats_elapsed").innerHTML = oy_local_elapsed.toFixed(2)+oy_suffix;
        }

        if (window.OY_EXECUTE_PULL===true||window.OY_EXECUTE_RECOMMIT===true) {
            let oy_local_elapsed = ((Date.now()/1000)-window.OY_PULL_ELAPSED);
            let oy_suffix = "&nbsp;sec";
            if (oy_local_elapsed>60) {
                oy_local_elapsed /= 60;
                oy_suffix = "&nbsp;min";
            }
            if (oy_local_elapsed>60) {
                oy_local_elapsed /= 60;
                oy_suffix = "&nbsp;hrs";
            }
            document.getElementById("oy_pull_stats_elapsed").innerHTML = oy_local_elapsed.toFixed(2)+oy_suffix;
        }

        document.getElementById("oy_self_short").innerHTML = ""+window.OY_MAIN['oy_self_short'];
        document.getElementById("oy_peer_count").innerHTML = ""+window.OY_PEER_COUNT;
        if (window.OY_PEER_COUNT===0) {
            document.getElementById("oy_peer_count_cont").style.color = "#000000";
            document.getElementById("oy_peer_count_cont").style.backgroundColor = "#c37b2c";
        }
        else if (window.OY_PEER_COUNT<=2) {
            document.getElementById("oy_peer_count_cont").style.color = "#000000";
            document.getElementById("oy_peer_count_cont").style.backgroundColor = "#cbba3c";
        }
        else {
            document.getElementById("oy_peer_count_cont").style.color = null;
            document.getElementById("oy_peer_count_cont").style.backgroundColor = null;
        }
        document.getElementById("oy_blacklisted").innerHTML = ""+Object.keys(window.OY_BLACKLIST).length;
        setTimeout("oy_maintain()", 200);
    }

    function oy_console_local(oy_console_msg) {
        let oy_msg_build = "<span>";
        if (typeof(window.OY_MAIN['oy_self_short'])==="undefined") oy_msg_build += "null@mesh$ ";
        else oy_msg_build += window.OY_MAIN['oy_self_short']+"@mesh$ ";
        oy_element_add("oy_console", "span", "oy_console_line_"+window.OY_CONSOLE_COUNTER, oy_msg_build+oy_console_msg+"<br>");
        window.OY_CONSOLE_COUNTER++;
        if (window.OY_CONSOLE_COUNTER>=window.OY_CONSOLE_SIZE) oy_element_remove("oy_console_line_"+(window.OY_CONSOLE_COUNTER-window.OY_CONSOLE_SIZE));
        if (window.OY_CONSOLE_HOVER===false) document.getElementById("oy_console").scrollTo(0, 9000);
    }

    function oy_console_hover_on() {
        window.OY_CONSOLE_HOVER = true;
        document.getElementById("oy_console_hover_indicator").style.display = "block";
    }

    function oy_console_hover_off() {
        window.OY_CONSOLE_HOVER = false;
        document.getElementById("oy_console_hover_indicator").style.display = "none";
        document.getElementById("oy_console").scrollTo(0, 9000);
    }

    function oy_top_init() {
        window.OY_MESH_TOP_PREV = [[], []];
        window.OY_TOP_WIDTH = screen.width/3;
        window.OY_TOP_HEIGHT = screen.height/3;

        window.OY_TOP_FORCE = d3.layout.force()
            .size([window.OY_TOP_WIDTH, window.OY_TOP_HEIGHT])
            .nodes([])
            .gravity(.1)
            .linkDistance(35)
            .linkStrength(0.7)
            .charge(-35)
            .on("tick", oy_top_tick);

        let oy_svg = d3.select("#oy_top_inner").append("svg")
            .attr("width", window.OY_TOP_WIDTH)
            .attr("height", window.OY_TOP_HEIGHT);

        oy_svg.append("rect")
            .attr("width", window.OY_TOP_WIDTH)
            .attr("height", window.OY_TOP_HEIGHT);

        window.OY_TOP_NODES = window.OY_TOP_FORCE.nodes();
        window.OY_TOP_LINKS = window.OY_TOP_FORCE.links();
        window.OY_TOP_NODE = oy_svg.selectAll(".node");
        window.OY_TOP_LINK = oy_svg.selectAll(".link");

        oy_top_restart("#348fab");
    }

    function oy_top_node_add(oy_node_short, oy_type) {
        if (typeof(window.OY_NODE_CHECK[oy_node_short])==="undefined") {
            window.OY_NODE_CHECK[oy_node_short] = true;
            window.OY_TOP_NODES.push({short:oy_node_short, x: Math.random()*window.OY_TOP_WIDTH|0, y: Math.random()*window.OY_TOP_HEIGHT|0,});
            if (oy_type==="self") oy_top_restart("#24ab26");
            else oy_top_restart("#348fab");
        }
    }

    function oy_top_node_remove(oy_node_short) {
        if (typeof(window.OY_NODE_KEEP[oy_node_short])!=="undefined") {
            delete window.OY_NODE_KEEP[oy_node_short];
            delete window.OY_NODE_CHECK[oy_node_short];
            for (let i in window.OY_TOP_NODES) {
                if (window.OY_TOP_NODES[i].short===oy_node_short) {
                    let oy_links_remove = [];
                    window.OY_TOP_LINKS = window.OY_TOP_LINKS.filter(function (l) {
                        let oy_condition = l.source.short !== window.OY_TOP_NODES[i].short && l.target.short !== window.OY_TOP_NODES[i].short;
                        if (!oy_condition) oy_links_remove.push([l.source.short, l.target.short]);
                        return oy_condition;
                    });
                    window.OY_TOP_NODES.splice(i, 1);
                    oy_top_restart("#348fab");
                }
            }
        }
    }

    function oy_top_link_add(oy_node_a, oy_node_b, oy_fill) {
        let oy_node_collect = [];
        window.OY_TOP_NODES.forEach(function(target) {
            if (target.short===oy_node_a||target.short===oy_node_b) oy_node_collect.push(target);
        });
        if (oy_node_collect.length===2) {
            window.OY_TOP_LINKS.push({source: oy_node_collect[0], target: oy_node_collect[1]});
            oy_top_restart(oy_fill);
        }
    }

    function oy_top_link_remove(oy_node_a, oy_node_b) {
        window.OY_TOP_LINKS = window.OY_TOP_LINKS.filter(function(l) {
            return !((l.source.short===oy_node_a&&l.target.short===oy_node_b)||
                (l.source.short===oy_node_b&&l.target.short===oy_node_a));
        });
    }

    function oy_top_clear() {
        window.OY_TOP_FORCE = null;
        document.getElementById("oy_top_inner").innerHTML = "";
    }

    function oy_top_tick() {
        window.OY_TOP_LINK.attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

        window.OY_TOP_NODE.attr("cx", function(d) { return d.x; })
            .attr("cy", function(d) { return d.y; });
    }

    function oy_top_restart(oy_fill) {
        if (window.OY_TOP_FORCE===null) return false;
        window.OY_TOP_NODE = window.OY_TOP_NODE.data(window.OY_TOP_NODES);

        window.OY_TOP_NODE.enter().insert("circle")
            .attr("class", "node")
            .attr("r", 5)
            .style("fill", oy_fill);

        window.OY_TOP_NODE.exit()
            .remove();

        window.OY_TOP_LINK = window.OY_TOP_LINK.data(window.OY_TOP_LINKS);

        window.OY_TOP_LINK.enter().insert("line", ".node")
            .attr("class", "link")
            .style("stroke", oy_fill);

        window.OY_TOP_LINK.exit()
            .remove();

        window.OY_TOP_FORCE.start();
    }

    function oy_element_add(oy_parent_id, oy_element_tag, oy_element_id, oy_element_html) {
        let oy_element = document.createElement(oy_element_tag);
        oy_element.setAttribute('id', oy_element_id);
        oy_element.innerHTML = oy_element_html;
        document.getElementById(oy_parent_id).appendChild(oy_element);
    }

    function oy_element_remove(oy_element_id) {
        let oy_element = document.getElementById(oy_element_id);
        oy_element.parentNode.removeChild(oy_element);
    }

    function oy_graph_nonce_set(oy_nonce_max) {
        if (oy_nonce_max===null) {
            let oy_parent = document.getElementById("oy_graph_nonce");
            while (oy_parent.firstChild) oy_parent.removeChild(oy_parent.firstChild);
            return true;
        }
        let oy_nonce_counter = 0;
        let oy_nonce_buffer = 0.2;
        let oy_nonce_left = 0;
        let oy_nonce_width = 100/oy_nonce_max;
        while (oy_nonce_counter<oy_nonce_max) {
            oy_element_add("oy_graph_nonce", "div", "oy_graph_nonce_"+oy_nonce_counter, "");
            let oy_nonce_local = document.getElementById("oy_graph_nonce_"+oy_nonce_counter);
            oy_nonce_local.style.position = "absolute";
            oy_nonce_local.style.top = "-5%";
            oy_nonce_local.style.left = oy_nonce_left+"%";
            oy_nonce_local.style.height = "110%";
            oy_nonce_local.style.width = (oy_nonce_width+oy_nonce_buffer)+"%";
            oy_nonce_local.style.zIndex = ""+oy_nonce_counter;
            oy_nonce_local.style.transition = "all .6s ease-out";
            oy_nonce_left += oy_nonce_width;
            oy_nonce_counter++;
            setTimeout(function() {
                oy_nonce_local.style.backgroundColor = "#828282";
            }, 1);
        }
    }

    function oy_graph_nonce_colour(oy_tally_count) {
        let oy_brightness = 200;
        let oy_intensity = 30;
        let oy_green = 10;
        let oy_blue = oy_brightness;

        oy_green += oy_tally_count*oy_intensity;

        if (oy_green>oy_brightness) {
            oy_blue -= oy_green-oy_brightness;
            oy_green = oy_brightness;
        }
        if (oy_blue<0) oy_blue = 0;

        return [0, oy_green, oy_blue];
    }

    function oy_graph_nonce_fill(oy_nonce, oy_colour) {
        if (oy_nonce===true) {
            let oy_children = document.getElementById("oy_graph_nonce").children;
            for (let i = 0; i < oy_children.length; i++) {
                let oy_graph_nonce_sub = oy_children[i];
                oy_graph_nonce_sub.style.backgroundColor = "rgb(+"+oy_colour[0]+", "+oy_colour[1]+", "+oy_colour[2]+")";
            }
            return true;
        }
        if (!document.getElementById("oy_graph_nonce_"+oy_nonce)) return false;
        if (oy_colour===null) document.getElementById("oy_graph_nonce_"+oy_nonce).style.backgroundColor = "#828282";
        else document.getElementById("oy_graph_nonce_"+oy_nonce).style.backgroundColor = "rgb(+"+oy_colour[0]+", "+oy_colour[1]+", "+oy_colour[2]+")";
        return true;
    }

    function oy_graph_peer(oy_graph_slot, oy_peer_short, oy_peer_info, oy_beam_ratio) {
        if (window.OY_GRAPH_PEERS[oy_graph_slot]===false&&oy_peer_short!==null) {
            window.OY_GRAPH_PEERS[oy_graph_slot] = oy_peer_short;
            oy_element_add("oy_graph_slot_"+oy_graph_slot, "div", "oy_graph_slot_"+oy_graph_slot+"_base", "<div id='oy_graph_slot_"+oy_graph_slot+"_front' style='transition: all .3s ease-out;z-index:300;'><div id='oy_graph_slot_"+oy_graph_slot+"_name'>"+oy_peer_short+oy_peer_info+"</div></div><div id='oy_graph_slot_"+oy_graph_slot+"_beam' style='transition: all .3s ease-out;z-index:200;'></div><div id='oy_graph_slot_"+oy_graph_slot+"_soak' style='z-index:100;'></div>");
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_name").classList.add("oy_center_both");
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_front").classList.add("oy_peer_sub");
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_base").classList.add("oy_peer_sub");
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_soak").classList.add("oy_peer_soak");
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_beam").classList.add("oy_peer_beam");
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_beam").style.width = oy_beam_ratio+"%";
            document.getElementById("oy_graph_slot_"+oy_graph_slot+"_front").style.backgroundColor = "#348fab";
            setTimeout(function() {
                document.getElementById("oy_graph_slot_"+oy_graph_slot+"_front").style.backgroundColor = "transparent";
            }, 400);
        }
        else if (window.OY_GRAPH_PEERS[oy_graph_slot]!==false) {
            if (oy_peer_short===null) {
                window.OY_GRAPH_PEERS[oy_graph_slot] = false;
                document.getElementById("oy_graph_slot_"+oy_graph_slot+"_front").style.backgroundColor = "#c37b2c";
                setTimeout(function() {
                    oy_element_remove("oy_graph_slot_"+oy_graph_slot+"_base");
                }, 400);
            }
            else {
                window.OY_GRAPH_PEERS[oy_graph_slot] = oy_peer_short;
                document.getElementById("oy_graph_slot_"+oy_graph_slot+"_name").innerHTML = oy_peer_short+oy_peer_info;
                document.getElementById("oy_graph_slot_"+oy_graph_slot+"_beam").style.width = oy_beam_ratio+"%";
            }
        }
    }

    function b64toBlob(b64Data, contentType, sliceSize) {
        contentType = contentType || '';
        sliceSize = sliceSize || 512;

        var byteCharacters = atob(b64Data);
        var byteArrays = [];

        for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {
            var slice = byteCharacters.slice(offset, offset + sliceSize);

            var byteNumbers = new Array(slice.length);
            for (var i = 0; i < slice.length; i++) {
                byteNumbers[i] = slice.charCodeAt(i);
            }

            var byteArray = new Uint8Array(byteNumbers);

            byteArrays.push(byteArray);
        }

        return new Blob(byteArrays, {type: contentType});
    }

    function oy_file_read(oy_file_object, oy_callback) {
        let file = oy_file_object.target.files[0];
        if (!file) {
            return false;
        }
        let reader = new FileReader();
        reader.onload = function(oy_file_object) {
            oy_callback(JSON.stringify([file.name, file.type, oy_file_object.target.result]));
        };
        reader.readAsBinaryString(file);
    }

    function oy_file_change(oy_file_object) {
        oy_file_read(oy_file_object, function(oy_file_data) {
            window.OY_FILE_DATA = null;
            oy_push_reset();
            window.OY_FILE_DATA = oy_file_data;

            document.getElementById("oy_push_reset").classList.remove("oy_button_all_dull");
            document.getElementById("oy_push_reset").classList.add("oy_button_reset_active");

            if (window.OY_EXECUTE_PULL===false&&window.OY_EXECUTE_RECOMMIT===false) {
                document.getElementById("oy_push_execute").classList.remove("oy_button_all_dull");
                document.getElementById("oy_push_execute").classList.add("oy_button_execute_active");
            }
        });
    }

    function oy_file_view_check(oy_type) {
        console.log(window.OY_FILE_KEEP[1]);
        if ((oy_type==="oy_image"||oy_type===true)&&(window.OY_FILE_KEEP[1]==="image/png"||window.OY_FILE_KEEP[1]==="image/jpg")) return true;
        else if ((oy_type==="oy_audio"||oy_type===true)&&(window.OY_FILE_KEEP[1]==="audio/mpeg"||window.OY_FILE_KEEP[1]==="audio/wav"||window.OY_FILE_KEEP[1]==="audio/ogg"||window.OY_FILE_KEEP[1]==="audio/x-m4a")) return true;
        else if ((oy_type==="oy_video"||oy_type===true)&&(window.OY_FILE_KEEP[1]==="video/mp4"||window.OY_FILE_KEEP[1]==="video/webm"||window.OY_FILE_KEEP[1]==="video/ogg")) return true;
        else if ((oy_type==="oy_document"||oy_type===true)&&(window.OY_FILE_KEEP[1]==="application/pdf")) return true;
        return false;
    }

    function oy_file_view() {
        if (window.OY_FILE_KEEP===null) return false;
        if (oy_file_view_check("oy_image")) {
            document.getElementById("oy_file_view_data").innerHTML = "<img style=\"width:auto;height:auto;max-height:85vh;max-width:85vw;\" src=\"data:"+window.OY_FILE_KEEP[1]+";base64,"+window.OY_FILE_KEEP[2]+"\">";
            document.getElementById("oy_cover").style.display = "block";
            document.getElementById("oy_file_view_cont").style.display = "block";
            return true;
        }
        else if (oy_file_view_check("oy_audio")) {
            document.getElementById("oy_file_view_data").innerHTML = "<audio controls src=\"data:"+window.OY_FILE_KEEP[1]+";base64,"+window.OY_FILE_KEEP[2]+"\">";
            document.getElementById("oy_cover").style.display = "block";
            document.getElementById("oy_file_view_cont").style.display = "block";
            return true;
        }
        else if (oy_file_view_check("oy_video")) {
            document.getElementById("oy_file_view_data").innerHTML = "<video controls src=\"data:"+window.OY_FILE_KEEP[1]+";base64,"+window.OY_FILE_KEEP[2]+"\">";
            document.getElementById("oy_cover").style.display = "block";
            document.getElementById("oy_file_view_cont").style.display = "block";
            return true;
        }
        else if (oy_file_view_check("oy_document")) {
            document.getElementById("oy_file_view_data").innerHTML = "<embed style=\"height:85vh;width:75vw;\" src=\"data:"+window.OY_FILE_KEEP[1]+";base64,"+window.OY_FILE_KEEP[2]+"\">";
            document.getElementById("oy_cover").style.display = "block";
            document.getElementById("oy_file_view_cont").style.display = "block";
            return true;
        }
        return false;
    }

    function oy_file_view_close() {
        document.getElementById("oy_file_view_cont").style.display = "none";
        document.getElementById("oy_cover").style.display = "none";
        document.getElementById("oy_file_view_data").innerHTML = "";
    }

    function oy_file_download() {
        if (window.OY_FILE_KEEP===null) return false;
        var blobUrl = URL.createObjectURL(b64toBlob(window.OY_FILE_KEEP[2], window.OY_FILE_KEEP[1]));
        var a = document.createElement("a");
        document.body.appendChild(a);
        a.style = "display: none";
        a.href = blobUrl;
        a.download = window.OY_FILE_KEEP[0];
        a.click();
        window.URL.revokeObjectURL(blobUrl);
    }

    function oy_push_superhandle_copy() {
        if (window.OY_HANDLE_PUSH!==null) {
            document.getElementById("oy_push_superhandle").select();
            document.execCommand("copy");
            document.getElementById("oy_tooltip_push").innerHTML = "Copied handle";
            window.OY_HANDLE_PUSH_COPY = true;
        }
    }

    function oy_push_superhandle_reset() {
        document.getElementById("oy_tooltip_push").innerHTML = "Copy to clipboard";
    }

    function oy_push_execute() {
        if (document.getElementById("oy_push_execute").classList.contains("oy_button_all_dull")) return false;
        window.OY_EXECUTE_PUSH = true;

        if (window.OY_PUSH_PAUSE===null) window.OY_PUSH_ELAPSED = Date.now()/1000;
        else window.OY_PUSH_ELAPSED += Date.now()/1000 - window.OY_PUSH_PAUSE;

        document.getElementById("oy_push_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_push_execute").classList.add("oy_button_all_dull");

        if (window.OY_HANDLE_PUSH===null) {
            document.getElementById("oy_push_execute").style.backgroundColor = "#cbba3c";
            document.getElementById("oy_push_execute").style.animation = "flash linear 0.3s infinite";
        }

        document.getElementById("oy_push_reset").classList.remove("oy_button_reset_active");
        document.getElementById("oy_push_reset").classList.add("oy_button_all_dull");

        document.getElementById("oy_file_upload").disabled = "disabled";

        document.getElementById("oy_pull_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_pull_execute").classList.add("oy_button_all_dull");

        if (window.OY_DEST_RADIO==="oy_dest_recommit") {
            document.getElementById("oy_dest_go").classList.remove("oy_button_pull_go");
            document.getElementById("oy_dest_go").classList.add("oy_button_all_dull");
        }

        if (document.getElementById("oy_push_mesh_glue_sub").innerHTML.substr(1, 1)==="-") document.getElementById("oy_push_mesh_glue_sub").innerHTML = "G0/00%";
        setTimeout(function() {
            oy_push_execute_post();
        }, 100);
    }

    function oy_push_execute_post() {
        let oy_callback_tally = function(oy_data_nonce, oy_tally_count, oy_passport_passive_length) {
            oy_graph_nonce_fill(oy_data_nonce, oy_graph_nonce_colour(oy_tally_count));
            window.OY_MESH_GLUE[oy_data_nonce] = oy_tally_count;
            let oy_data_nonce_count = 0;
            let oy_glue_lowest = 9;
            for (let oy_data_nonce_sub in window.OY_MESH_GLUE) {
                if (window.OY_MESH_GLUE[oy_data_nonce_sub]<oy_glue_lowest) oy_glue_lowest = window.OY_MESH_GLUE[oy_data_nonce_sub];
            }
            for (let oy_data_nonce_sub in window.OY_MESH_GLUE) {
                if (window.OY_MESH_GLUE[oy_data_nonce_sub]===oy_glue_lowest) oy_data_nonce_count++;
            }
            let oy_data_nonce_percent = Math.floor(((window.OY_NONCE_MAX_PUSH-oy_data_nonce_count)/window.OY_NONCE_MAX_PUSH)*100);
            if (oy_data_nonce_percent===100) oy_data_nonce_percent = 99;
            if (oy_data_nonce_percent<10) oy_data_nonce_percent = "0"+oy_data_nonce_percent;
            document.getElementById("oy_push_mesh_glue_sub").innerHTML = "G"+oy_glue_lowest+"/"+oy_data_nonce_percent+"%";

            window.OY_PUSH_AVG_HOP.push(oy_passport_passive_length);
            while (window.OY_PUSH_AVG_HOP.length>window.OY_HOP_KEEP) window.OY_PUSH_AVG_HOP.shift();
            document.getElementById("oy_push_stats_avg_hop").innerHTML = (window.OY_PUSH_AVG_HOP.reduce(oy_reduce_sum)/window.OY_PUSH_AVG_HOP.length).toFixed(2);
        };
        if (window.OY_HANDLE_PUSH===null) {
            let oy_superhandle = oy_data_push(window.OY_FILE_DATA, null, oy_callback_tally);
            window.OY_FILE_DATA = "oy_null";
            document.getElementById("oy_push_superhandle").value = oy_superhandle;
            let oy_superhandle_split = oy_superhandle.split("@");
            window.OY_HANDLE_PUSH = oy_superhandle_split[0].substr(0, 46);
            window.OY_HANDLE_PUSH_COPY = false;
            document.getElementById("oy_tooltip_push").style.display = "block";
            window.OY_NONCE_MAX_PUSH = parseInt(oy_superhandle_split[0].substr(46));
            oy_graph_nonce_set(window.OY_NONCE_MAX_PUSH);
            let oy_nonce_counter = 0;
            while (oy_nonce_counter<window.OY_NONCE_MAX_PUSH) {
                window.OY_MESH_GLUE[oy_nonce_counter] = 0;
                oy_nonce_counter++;
            }
        }
        else {
            if (window.OY_EXECUTE_LAST!=="OY_PUSH") document.getElementById("oy_graph_nonce").innerHTML = window.OY_GRAPH_NONCE_STORE["OY_PUSH"];
            window.OY_DATA_PUSH[window.OY_HANDLE_PUSH] = oy_callback_tally;
            oy_data_push(null, window.OY_HANDLE_PUSH, oy_callback_tally);
        }
        document.getElementById("oy_push_halt").classList.remove("oy_button_all_dull");
        document.getElementById("oy_push_halt").classList.add("oy_button_halt_active");

        document.getElementById("oy_push_execute").style.backgroundColor = null;
        document.getElementById("oy_push_execute").style.animation = null;
        window.OY_EXECUTE_LAST = "OY_PUSH";
    }

    function oy_push_halt() {
        if (document.getElementById("oy_push_halt").classList.contains("oy_button_all_dull")) return false;
        window.OY_EXECUTE_PUSH = false;

        window.OY_PUSH_PAUSE = Date.now()/1000;

        document.getElementById("oy_push_execute").classList.remove("oy_button_all_dull");
        document.getElementById("oy_push_execute").classList.add("oy_button_execute_active");

        document.getElementById("oy_push_halt").classList.remove("oy_button_halt_active");
        document.getElementById("oy_push_halt").classList.add("oy_button_all_dull");

        document.getElementById("oy_push_reset").classList.remove("oy_button_all_dull");
        document.getElementById("oy_push_reset").classList.add("oy_button_reset_active");

        if (document.getElementById("oy_pull_superhandle").value.length>=80&&document.getElementById("oy_pull_superhandle").value.substr(0, 1)!=="-") {
            document.getElementById("oy_pull_execute").classList.remove("oy_button_all_dull");
            document.getElementById("oy_pull_execute").classList.add("oy_button_execute_active");
        }

        document.getElementById("oy_file_upload").disabled = null;

        window.OY_DATA_PUSH[window.OY_HANDLE_PUSH] = false;

        window.OY_GRAPH_NONCE_STORE["OY_PUSH"] = document.getElementById("oy_graph_nonce").innerHTML;
    }

    function oy_push_reset() {
        if (document.getElementById("oy_push_reset").classList.contains("oy_button_all_dull")) return false;
        //if (window.OY_EXECUTE_PUSH===true||window.OY_FILE_DATA===null) return false;
        document.getElementById("oy_push_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_push_execute").classList.add("oy_button_all_dull");

        document.getElementById("oy_push_reset").classList.remove("oy_button_reset_active");
        document.getElementById("oy_push_reset").classList.add("oy_button_all_dull");

        if (window.OY_HANDLE_PUSH!==null) oy_data_push_reset(window.OY_HANDLE_PUSH);
        if (window.OY_EXECUTE_PULL===false&&window.OY_EXECUTE_RECOMMIT===false) oy_graph_nonce_set(null);
        delete window.OY_GRAPH_NONCE_STORE["OY_PUSH"];
        window.OY_HANDLE_PUSH = null;
        window.OY_HANDLE_PUSH_COPY = null;
        window.OY_NONCE_MAX_PUSH = null;
        window.OY_FILE_DATA = null;
        window.OY_PUSH_PAUSE = null;
        window.OY_MESH_GLUE = [];
        document.getElementById("oy_file_upload").value = "";
        document.getElementById("oy_push_superhandle").value = "-".repeat(82);
        document.getElementById("oy_push_mesh_glue_sub").innerHTML = "G-/--%";
        document.getElementById("oy_tooltip_push").style.display = "none";
        oy_push_reset_handle_leave();
    }

    function oy_push_reset_handle_enter() {
        if (window.OY_HANDLE_PUSH_COPY===false&&window.OY_EXECUTE_PUSH===false&&window.OY_FILE_DATA!==null) document.getElementById("oy_tooltip_push_warn").style.opacity = "1";
    }

    function oy_push_reset_handle_leave() {
        document.getElementById("oy_tooltip_push_warn").style.opacity = null;
    }

    function oy_dest_radio(oy_radio_select) {
        if (document.getElementById(oy_radio_select).disabled===true) return false;
        document.getElementById(oy_radio_select).checked = true;
        if (oy_radio_select==="oy_dest_recommit") {
            document.getElementById("oy_dest_view").checked = false;
            document.getElementById("oy_dest_download").checked = false;

            if (window.OY_FILE_KEEP!==null&&window.OY_EXECUTE_PUSH===false&&window.OY_EXECUTE_RECOMMIT===false) {
                document.getElementById("oy_dest_go").classList.remove("oy_button_all_dull");
                document.getElementById("oy_dest_go").classList.add("oy_button_pull_go");
            }
            else {
                document.getElementById("oy_dest_go").classList.remove("oy_button_pull_go");
                document.getElementById("oy_dest_go").classList.add("oy_button_all_dull");
            }
        }
        else if (oy_radio_select==="oy_dest_view") {
            document.getElementById("oy_dest_recommit").checked = false;
            document.getElementById("oy_dest_download").checked = false;

            if (window.OY_FILE_KEEP!==null&&window.OY_FILE_KEEP[0]!==null) {
                document.getElementById("oy_dest_go").classList.remove("oy_button_all_dull");
                document.getElementById("oy_dest_go").classList.add("oy_button_pull_go");
            }
            else {
                document.getElementById("oy_dest_go").classList.remove("oy_button_pull_go");
                document.getElementById("oy_dest_go").classList.add("oy_button_all_dull");
            }
        }
        else if (oy_radio_select==="oy_dest_download") {
            document.getElementById("oy_dest_recommit").checked = false;
            document.getElementById("oy_dest_view").checked = false;

            if (window.OY_FILE_KEEP!==null&&window.OY_FILE_KEEP[0]!==null) {
                document.getElementById("oy_dest_go").classList.remove("oy_button_all_dull");
                document.getElementById("oy_dest_go").classList.add("oy_button_pull_go");
            }
            else {
                document.getElementById("oy_dest_go").classList.remove("oy_button_pull_go");
                document.getElementById("oy_dest_go").classList.add("oy_button_all_dull");
            }
        }
        else return false;
        window.OY_DEST_RADIO = oy_radio_select;
        return true;
    }

    function oy_dest_radio_view_enable() {
        document.getElementById("oy_dest_view").disabled = false;
        document.getElementById("oy_dest_view_inner").style.textDecoration = null;
        return true;
    }

    function oy_dest_radio_view_disable() {
        document.getElementById("oy_dest_view").disabled = "disabled";
        document.getElementById("oy_dest_view_inner").style.textDecoration = "line-through";
        return true;
    }

    function oy_dest_radio_download_enable() {
        document.getElementById("oy_dest_download").disabled = false;
        document.getElementById("oy_dest_download_inner").style.textDecoration = null;
        return true;
    }

    function oy_dest_radio_download_disable() {
        if (window.OY_DEST_RADIO!=="oy_dest_recommit") oy_dest_radio("oy_dest_download");

        document.getElementById("oy_dest_download").disabled = "disabled";
        document.getElementById("oy_dest_download_inner").style.textDecoration = "line-through";
        return true;
    }

    function oy_dest_go() {
        if (document.getElementById("oy_dest_go").classList.contains("oy_button_all_dull")||window.OY_EXECUTE_PULL===true||window.OY_FILE_KEEP===null) return false;
        if (window.OY_DEST_RADIO==="oy_dest_view") oy_file_view();
        else if (window.OY_DEST_RADIO==="oy_dest_download") oy_file_download();
        else if (window.OY_DEST_RADIO==="oy_dest_recommit") oy_recommit_execute();
        else return false;
        return true;
    }

    function oy_pull_execute() {
        if (document.getElementById("oy_pull_execute").classList.contains("oy_button_all_dull")) return false;
        //if (window.OY_EXECUTE_PUSH===true||window.OY_EXECUTE_PULL===true||window.OY_EXECUTE_RECOMMIT===true) return false;
        window.OY_EXECUTE_PULL = true;
        document.getElementById("oy_pull_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_pull_execute").classList.add("oy_button_all_dull");

        document.getElementById("oy_pull_halt").classList.remove("oy_button_all_dull");
        document.getElementById("oy_pull_halt").classList.add("oy_button_halt_active");

        document.getElementById("oy_pull_reset").classList.remove("oy_button_reset_active");
        document.getElementById("oy_pull_reset").classList.add("oy_button_all_dull");

        document.getElementById("oy_push_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_push_execute").classList.add("oy_button_all_dull");

        if (document.getElementById('oy_pull_superhandle').value.indexOf("@")===-1) {
            window.OY_NONCE_MAX_PULL = parseInt(document.getElementById('oy_pull_superhandle').value.substr(46));
            oy_dest_radio_view_disable();
            oy_dest_radio_download_disable();
            if (window.OY_DEST_RADIO!=="oy_dest_recommit") oy_dest_radio("oy_dest_recommit");
        }
        else window.OY_NONCE_MAX_PULL = parseInt(document.getElementById('oy_pull_superhandle').value.split("@")[0].substr(46));
        if (window.OY_HANDLE_PULL===null) oy_graph_nonce_set(window.OY_NONCE_MAX_PULL);
        else if (window.OY_EXECUTE_LAST!=="OY_PULL") document.getElementById("oy_graph_nonce").innerHTML = window.OY_GRAPH_NONCE_STORE["OY_PULL"];

        document.getElementById('oy_pull_superhandle').disabled = "disabled";

        window.OY_HANDLE_PULL = document.getElementById('oy_pull_superhandle').value.substr(0, 46);

        if (window.OY_PULL_PAUSE===null) window.OY_PULL_ELAPSED = Date.now()/1000;
        else window.OY_PULL_ELAPSED += Date.now()/1000 - window.OY_PULL_PAUSE;

        delete window.OY_DATA_PULL[window.OY_HANDLE_PULL];
        oy_data_pull(function(oy_superhandle, oy_data_value, oy_data_crypt) {
            oy_tab("oy_tab_download");
            oy_pull_halt(true);
            oy_graph_nonce_fill(true, oy_graph_nonce_colour(100));
            if (oy_data_value===null) window.OY_FILE_KEEP = [null, null, null, true];
            else {
                window.OY_FILE_KEEP = JSON.parse(oy_data_value);
                oy_data_value = null;
                window.OY_FILE_KEEP[2] = window.btoa(window.OY_FILE_KEEP[2]);
            }
            window.OY_FILE_KEEP[3] = oy_data_crypt;
            oy_data_crypt = null;

            if (window.OY_DEST_RADIO!=="oy_dest_recommit") {
                document.getElementById("oy_dest_go").classList.remove("oy_button_all_dull");
                document.getElementById("oy_dest_go").classList.add("oy_button_pull_go");
            }

            if (!oy_file_view_check(true)||window.OY_FILE_KEEP[0]===null) {
                oy_dest_radio_view_disable();
                if (window.OY_DEST_RADIO!=="oy_dest_recommit") oy_dest_radio("oy_dest_download");
            }
            if (window.OY_DEST_RADIO==="oy_dest_recommit") setTimeout("oy_recommit_execute()", 500);
            else if (window.OY_DEST_RADIO==="oy_dest_download"||(window.OY_DEST_RADIO==="oy_dest_view"&&!oy_file_view())) oy_file_download();
        }, document.getElementById('oy_pull_superhandle').value,
        function(oy_data_nonce, oy_collect_count, oy_data_count) {
            if (oy_collect_count>0&&window.OY_PULL_COVERAGE.indexOf(oy_data_nonce)===-1) {
                window.OY_PULL_COVERAGE.push(oy_data_nonce);
                document.getElementById("oy_pull_stats_coverage").innerHTML = Math.floor((window.OY_PULL_COVERAGE.length/window.OY_NONCE_MAX_PULL)*100)+"%";
            }
            if (window.OY_EXECUTE_PULL===true&&oy_data_count>0) {
                if (oy_data_count===1) delete window.OY_PULL_CONFLICTS[oy_data_nonce];
                else window.OY_PULL_CONFLICTS[oy_data_nonce] = true;
                document.getElementById("oy_pull_stats_conflicts").innerHTML = ""+Object.keys(window.OY_PULL_CONFLICTS).length;
            }
            oy_graph_nonce_fill(oy_data_nonce, oy_graph_nonce_colour(oy_collect_count));
        });
        window.OY_EXECUTE_LAST = "OY_PULL";
    }

    function oy_pull_halt(oy_switch) {
        if (document.getElementById("oy_pull_halt").classList.contains("oy_button_all_dull")) return false;

        if (window.OY_EXECUTE_RECOMMIT===true) {
            oy_recommit_halt();
            return true;
        }
        window.OY_EXECUTE_PULL = false;

        window.OY_PULL_PAUSE = Date.now()/1000;

        if (typeof(oy_switch)==="undefined") {
            document.getElementById("oy_pull_execute").classList.remove("oy_button_all_dull");
            document.getElementById("oy_pull_execute").classList.add("oy_button_execute_active");
        }

        document.getElementById("oy_pull_halt").classList.remove("oy_button_halt_active");
        document.getElementById("oy_pull_halt").classList.add("oy_button_all_dull");

        document.getElementById("oy_pull_reset").classList.remove("oy_button_all_dull");
        document.getElementById("oy_pull_reset").classList.add("oy_button_reset_active");

        if (window.OY_FILE_DATA!==null) {
            document.getElementById("oy_push_execute").classList.remove("oy_button_all_dull");
            document.getElementById("oy_push_execute").classList.add("oy_button_execute_active");
        }

        if (typeof(oy_switch)==="undefined") window.OY_DATA_PULL[window.OY_HANDLE_PULL] = false;
        else delete window.OY_DATA_PULL[window.OY_HANDLE_PULL];

        window.OY_GRAPH_NONCE_STORE["OY_PULL"] = document.getElementById("oy_graph_nonce").innerHTML;
    }

    function oy_pull_reset() {
        if (document.getElementById("oy_pull_reset").classList.contains("oy_button_all_dull")) return false;
        //if (window.OY_EXECUTE_PULL===false) return false;
        window.OY_EXECUTE_PULL = false;

        document.getElementById("oy_pull_stats_beta").style.display = "block";
        document.getElementById("oy_pull_stats_cont").style.width = "32.5%";
        document.getElementById("oy_pull_stats_alpha").style.left = "3%";
        document.getElementById("oy_pull_mesh_glue").style.display = "none";
        document.getElementById("oy_pull_mesh_glue_sub").innerHTML = "G-/--%";

        document.getElementById("oy_pull_reset").classList.remove("oy_button_halt_active");
        document.getElementById("oy_pull_reset").classList.add("oy_button_all_dull");

        document.getElementById('oy_pull_superhandle').disabled = false;

        document.getElementById("oy_pull_superhandle").value = "";
        oy_pull_reset_handle_blur();
        oy_dest_radio_view_enable();
        oy_dest_radio_download_enable();

        document.getElementById("oy_pull_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_pull_execute").classList.add("oy_button_all_dull");

        document.getElementById("oy_pull_halt").classList.remove("oy_button_halt_active");
        document.getElementById("oy_pull_halt").classList.add("oy_button_all_dull");

        if (window.OY_EXECUTE_PUSH===false&&window.OY_FILE_DATA!==null) {
            document.getElementById("oy_push_execute").classList.remove("oy_button_all_dull");
            document.getElementById("oy_push_execute").classList.add("oy_button_execute_active");
        }

        document.getElementById("oy_dest_go").classList.remove("oy_button_pull_go");
        document.getElementById("oy_dest_go").classList.add("oy_button_all_dull");

        oy_data_pull_reset(window.OY_HANDLE_PULL);
        if (window.OY_EXECUTE_PUSH===false&&window.OY_EXECUTE_RECOMMIT===false) oy_graph_nonce_set(null);
        delete window.OY_GRAPH_NONCE_STORE["OY_PULL"];
        window.OY_FILE_KEEP = null;
        window.OY_HANDLE_PULL = null;
        oy_pull_reset_stats();
    }

    function oy_pull_reset_stats() {
        window.OY_PULL_AVG_HOP = [];
        window.OY_PULL_ELAPSED = null;
        window.OY_PULL_PAUSE = null;
        window.OY_RECOMMIT_PAUSE = null;
        window.OY_PULL_COVERAGE = [];
        window.OY_PULL_CONFLICTS = {};
        document.getElementById("oy_pull_stats_avg_hop").innerHTML = "0";
        document.getElementById("oy_pull_stats_elapsed").innerHTML = "0&nbsp;sec";
        document.getElementById("oy_pull_stats_coverage").innerHTML = "0%";
        document.getElementById("oy_pull_stats_conflicts").innerHTML = "0";
    }

    function oy_pull_reset_handle_click() {
        if (document.getElementById("oy_pull_reset").classList.contains("oy_button_all_dull")) document.getElementById("oy_pull_superhandle").value = "";
    }

    function oy_pull_reset_handle_blur() {
        if (document.getElementById("oy_pull_superhandle").value.substr(0, 2)!=="OY"&&document.getElementById("oy_pull_reset").classList.contains("oy_button_all_dull")) {
            document.getElementById("oy_pull_superhandle").value = "-".repeat(82);
            document.getElementById("oy_pull_execute").classList.remove("oy_button_execute_active");
            document.getElementById("oy_pull_execute").classList.add("oy_button_all_dull");

            document.getElementById("oy_pull_reset").classList.remove("oy_button_reset_active");
            document.getElementById("oy_pull_reset").classList.add("oy_button_all_dull");
        }
        else if (document.getElementById("oy_pull_superhandle").value.substr(0, 1)!=="-") {
            if (window.OY_EXECUTE_PUSH===false) {
                document.getElementById("oy_pull_execute").classList.remove("oy_button_all_dull");
                document.getElementById("oy_pull_execute").classList.add("oy_button_execute_active");
            }

            document.getElementById("oy_pull_reset").classList.remove("oy_button_all_dull");
            document.getElementById("oy_pull_reset").classList.add("oy_button_reset_active");
        }
    }

    function oy_recommit_execute() {
        if (window.OY_EXECUTE_PUSH===true||window.OY_EXECUTE_PULL===true||window.OY_EXECUTE_RECOMMIT===true) return false;
        window.OY_EXECUTE_RECOMMIT = true;

        document.getElementById("oy_dest_recommit_inner").style.animation = "flash_green linear 1s infinite";

        document.getElementById("oy_push_execute").classList.remove("oy_button_execute_active");
        document.getElementById("oy_push_execute").classList.add("oy_button_all_dull");

        document.getElementById("oy_pull_reset").classList.remove("oy_button_reset_active");
        document.getElementById("oy_pull_reset").classList.add("oy_button_all_dull");

        document.getElementById("oy_pull_halt").classList.remove("oy_button_all_dull");
        document.getElementById("oy_pull_halt").classList.add("oy_button_halt_active");

        if (window.OY_DEST_RADIO==="oy_dest_recommit") {
            document.getElementById("oy_dest_go").classList.remove("oy_button_pull_go");
            document.getElementById("oy_dest_go").classList.add("oy_button_all_dull");
        }

        document.getElementById("oy_pull_stats_beta").style.display = "none";
        document.getElementById("oy_pull_stats_cont").style.width = "15%";
        document.getElementById("oy_pull_mesh_glue").style.display = "block";

        if (window.OY_EXECUTE_LAST!=="OY_RECOMMIT") oy_pull_reset_stats();
        if (window.OY_RECOMMIT_PAUSE===null) window.OY_PULL_ELAPSED = Date.now()/1000;
        else window.OY_PULL_ELAPSED += Date.now()/1000 - window.OY_RECOMMIT_PAUSE;

        let oy_callback_tally = function(oy_data_nonce, oy_tally_count, oy_passport_passive_length) {
            oy_graph_nonce_fill(oy_data_nonce, oy_graph_nonce_colour(oy_tally_count));
            window.OY_MESH_GLUE[oy_data_nonce] = oy_tally_count;
            let oy_data_nonce_count = 0;
            let oy_glue_lowest = 9;
            for (let oy_data_nonce_sub in window.OY_MESH_GLUE) {
                if (window.OY_MESH_GLUE[oy_data_nonce_sub]<oy_glue_lowest) oy_glue_lowest = window.OY_MESH_GLUE[oy_data_nonce_sub];
            }
            for (let oy_data_nonce_sub in window.OY_MESH_GLUE) {
                if (window.OY_MESH_GLUE[oy_data_nonce_sub]===oy_glue_lowest) oy_data_nonce_count++;
            }
            let oy_data_nonce_percent = Math.floor(((window.OY_NONCE_MAX_PULL-oy_data_nonce_count)/window.OY_NONCE_MAX_PULL)*100);
            if (oy_data_nonce_percent===100) oy_data_nonce_percent = 99;
            if (oy_data_nonce_percent<10) oy_data_nonce_percent = "0"+oy_data_nonce_percent;
            document.getElementById("oy_pull_mesh_glue_sub").innerHTML = "G"+oy_glue_lowest+"/"+oy_data_nonce_percent+"%";

            window.OY_PULL_AVG_HOP.push(oy_passport_passive_length);
            while (window.OY_PULL_AVG_HOP.length>window.OY_HOP_KEEP) window.OY_PULL_AVG_HOP.shift();
            document.getElementById("oy_pull_stats_avg_hop").innerHTML = (window.OY_PULL_AVG_HOP.reduce(oy_reduce_sum)/window.OY_PULL_AVG_HOP.length).toFixed(2);
        };
        oy_data_pull_reset(window.OY_HANDLE_PULL);
        if (window.OY_EXECUTE_LAST!=="OY_RECOMMIT") {
            window.OY_MESH_GLUE = [];
            let oy_nonce_counter = 0;
            while (oy_nonce_counter<window.OY_NONCE_MAX_PULL) {
                window.OY_MESH_GLUE[oy_nonce_counter] = 0;
                oy_nonce_counter++;
            }
            oy_graph_nonce_set(null);
            oy_graph_nonce_set(window.OY_NONCE_MAX_PULL);
        }
        if (window.OY_EXECUTE_LAST!=="OY_RECOMMIT") delete window.OY_PUSH_HOLD[window.OY_HANDLE_PULL];
        window.OY_DATA_PUSH[window.OY_HANDLE_PULL] = oy_callback_tally;
        oy_data_push(window.OY_FILE_KEEP[3], window.OY_HANDLE_PULL);
        window.OY_EXECUTE_LAST = "OY_RECOMMIT";
    }

    function oy_recommit_halt() {
        if (window.OY_EXECUTE_RECOMMIT===false) return false;
        window.OY_EXECUTE_RECOMMIT = false;
        window.OY_DATA_PUSH[window.OY_HANDLE_PULL] = false;

        window.OY_RECOMMIT_PAUSE = Date.now()/1000;

        document.getElementById("oy_dest_recommit_inner").style.animation = null;

        if (window.OY_FILE_DATA!==null) {
            document.getElementById("oy_push_execute").classList.remove("oy_button_all_dull");
            document.getElementById("oy_push_execute").classList.add("oy_button_execute_active");
        }

        document.getElementById("oy_pull_reset").classList.remove("oy_button_all_dull");
        document.getElementById("oy_pull_reset").classList.add("oy_button_reset_active");

        document.getElementById("oy_pull_halt").classList.remove("oy_button_halt_active");
        document.getElementById("oy_pull_halt").classList.add("oy_button_all_dull");

        if (window.OY_DEST_RADIO==="oy_dest_recommit") {
            document.getElementById("oy_dest_go").classList.remove("oy_button_all_dull");
            document.getElementById("oy_dest_go").classList.add("oy_button_pull_go");
        }
    }

    function oy_tab(oy_tab_id) {
        if (oy_tab_id==="oy_tab_dapper") {
            document.getElementById('oy_tab_dapper').style.backgroundColor = "#404040";
            document.getElementById('oy_tab_wallet').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_upload').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_download').style.backgroundColor = "#7A7A7A";

            document.getElementById('oy_tab_dapper').style.color = "#d7d7d7";
            document.getElementById('oy_tab_wallet').style.color = "#232323";
            document.getElementById('oy_tab_upload').style.color = "#232323";
            document.getElementById('oy_tab_download').style.color = "#232323";

            if (window.OY_EXECUTE_PUSH===true) document.getElementById('oy_tab_upload').style.backgroundColor = "#c37b2c";
            if (window.OY_EXECUTE_PULL===true) document.getElementById('oy_tab_download').style.backgroundColor = "#c37b2c";

            document.getElementById('oy_interface_dapper').style.display = "block";
            document.getElementById('oy_interface_wallet').style.display = "none";
            document.getElementById('oy_interface_upload').style.display = "none";
            document.getElementById('oy_interface_download').style.display = "none";
        }
        else if (oy_tab_id==="oy_tab_wallet") {
            document.getElementById('oy_tab_dapper').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_wallet').style.backgroundColor = "#404040";
            document.getElementById('oy_tab_upload').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_download').style.backgroundColor = "#7A7A7A";

            document.getElementById('oy_tab_dapper').style.color = "#232323";
            document.getElementById('oy_tab_wallet').style.color = "#d7d7d7";
            document.getElementById('oy_tab_upload').style.color = "#232323";
            document.getElementById('oy_tab_download').style.color = "#232323";

            if (window.OY_EXECUTE_PUSH===true) document.getElementById('oy_tab_upload').style.backgroundColor = "#c37b2c";
            if (window.OY_EXECUTE_PULL===true) document.getElementById('oy_tab_download').style.backgroundColor = "#c37b2c";

            document.getElementById('oy_interface_dapper').style.display = "none";
            document.getElementById('oy_interface_wallet').style.display = "block";
            document.getElementById('oy_interface_upload').style.display = "none";
            document.getElementById('oy_interface_download').style.display = "none";
        }
        else if (oy_tab_id==="oy_tab_upload") {
            document.getElementById('oy_tab_dapper').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_wallet').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_upload').style.backgroundColor = "#404040";
            document.getElementById('oy_tab_download').style.backgroundColor = "#7A7A7A";

            document.getElementById('oy_tab_dapper').style.color = "#232323";
            document.getElementById('oy_tab_wallet').style.color = "#232323";
            document.getElementById('oy_tab_upload').style.color = "#d7d7d7";
            document.getElementById('oy_tab_download').style.color = "#232323";

            if (window.OY_EXECUTE_PULL===true) document.getElementById('oy_tab_download').style.backgroundColor = "#c37b2c";

            document.getElementById('oy_interface_dapper').style.display = "none";
            document.getElementById('oy_interface_wallet').style.display = "none";
            document.getElementById('oy_interface_upload').style.display = "block";
            document.getElementById('oy_interface_download').style.display = "none";
        }
        else if (oy_tab_id==="oy_tab_download") {
            document.getElementById('oy_tab_dapper').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_wallet').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_upload').style.backgroundColor = "#7A7A7A";
            document.getElementById('oy_tab_download').style.backgroundColor = "#404040";

            document.getElementById('oy_tab_dapper').style.color = "#232323";
            document.getElementById('oy_tab_wallet').style.color = "#232323";
            document.getElementById('oy_tab_upload').style.color = "#232323";
            document.getElementById('oy_tab_download').style.color = "#d7d7d7";

            if (window.OY_EXECUTE_PUSH===true) document.getElementById('oy_tab_upload').style.backgroundColor = "#c37b2c";

            document.getElementById('oy_interface_dapper').style.display = "none";
            document.getElementById('oy_interface_wallet').style.display = "none";
            document.getElementById('oy_interface_upload').style.display = "none";
            document.getElementById('oy_interface_download').style.display = "block";
        }
    }
</script>
</body>
</html>